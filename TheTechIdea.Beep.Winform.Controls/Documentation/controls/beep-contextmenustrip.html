<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeepPopupListFormStrip - Beep Controls Documentation</title>
    <link rel="stylesheet" href="../sphinx-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <img src="../assets/beep-logo.svg" alt="Beep Controls Logo">
                <div class="logo-text">
                    <h2>Beep Controls</h2>
                    <span class="version">v1.0.164</span>
                </div>
            </div>
            
            <!-- Search -->
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search documentation..." onkeyup="searchDocs(this.value)">
            </div>
            
            <nav>
                <ul class="nav-menu">
                    <li><a href="../index.html"><i class="bi bi-house"></i> Home</a></li>
                    <li class="has-submenu open">
                        <a href="#"><i class="bi bi-tools"></i> Specialized Controls</a>
                        <ul class="submenu">
                            <li><a href="beep-menubar.html">BeepMenuBar</a></li>
                            <li><a href="beep-toolstrip.html">BeepToolStrip</a></li>
                            <li><a href="beep-appbar.html">BeepAppBar</a></li>
                            <li><a href="beep-sidemenu.html">BeepSideMenu</a></li>
                            <li><a href="beep-contextmenustrip.html" class="active">BeepPopupListFormStrip</a></li>
                            <li><a href="beep-login.html">BeepLogin</a></li>
                            <li><a href="beep-wizard.html">BeepWizard</a></li>
                            <li><a href="beep-calendar.html">BeepCalendarView</a></li>
                        </ul>
                    </li>
                    <li><a href="../api/beep-control-base.html"><i class="bi bi-code-square"></i> API Reference</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb-nav">
                    <a href="../index.html">Home</a>
                    <span>?</span>
                    <a href="../index.html#specialized-controls">Specialized Controls</a>
                    <span>?</span>
                    <span>BeepPopupListFormStrip</span>
                </nav>

                <!-- Page Header -->
                <div class="page-header">
                    <h1>BeepPopupListFormStrip</h1>
                    <p class="page-subtitle">Modern context menu control with popup functionality and theme integration for contextual actions and navigation</p>
                </div>

                <!-- Table of Contents -->
                <div class="toc">
                    <h3>?? Table of Contents</h3>
                    <ul>
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#features">Key Features</a></li>
                        <li><a href="#visual-preview">Visual Preview</a></li>
                        <li><a href="#basic-usage">Basic Usage</a></li>
                        <li><a href="#properties">Properties</a></li>
                        <li><a href="#events">Events</a></li>
                        <li><a href="#examples">Examples</a></li>
                        <li><a href="#theming">Theming</a></li>
                        <li><a href="#best-practices">Best Practices</a></li>
                    </ul>
                </div>

                <!-- Overview -->
                <section id="overview" class="section">
                    <h2>Overview</h2>
                    <p>
                        <strong>BeepPopupListFormStrip</strong> provides a sophisticated context menu control that extends BeepListBox 
                        functionality to create modern, theme-aware popup menus. It offers flexible positioning, automatic sizing, 
                        click-outside-to-close behavior, and seamless integration with the BeepPopupForm system for professional 
                        contextual interfaces.
                    </p>
                    <p>
                        Built on the <strong>BeepListBox</strong> foundation, BeepPopupListFormStrip features automatic popup management, 
                        smart positioning, item selection handling, theme integration, and comprehensive event support. Perfect for 
                        right-click menus, dropdown options, action lists, and contextual navigation in modern Windows Forms applications.
                    </p>
                </section>

                <!-- Key Features -->
                <section id="features" class="section">
                    <h2>Key Features</h2>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3>??? Smart Popup System</h3>
                            <p>Automatic popup positioning with BeepPopupForm integration and outside-click handling</p>
                        </div>
                        <div class="feature-card">
                            <h3>?? Flexible Positioning</h3>
                            <p>Show context menus at any screen location with automatic boundary detection</p>
                        </div>
                        <div class="feature-card">
                            <h3>?? Theme Integration</h3>
                            <p>Complete theme support with modern styling and consistent visual appearance</p>
                        </div>
                        <div class="feature-card">
                            <h3>?? BeepListBox Heritage</h3>
                            <p>Inherits all BeepListBox functionality including icons, custom items, and layouts</p>
                        </div>
                        <div class="feature-card">
                            <h3>? Event-Driven</h3>
                            <p>Comprehensive event handling for item clicks, selection changes, and menu lifecycle</p>
                        </div>
                        <div class="feature-card">
                            <h3>?? Responsive Design</h3>
                            <p>Automatic sizing based on content with configurable appearance options</p>
                        </div>
                    </div>
                </section>

                <!-- Visual Preview -->
                <section id="visual-preview" class="section">
                    <h2>Visual Preview</h2>
                    
                    <h3>Standard Context Menu</h3>
                    <div class="visual-demo">
                        <div class="context-menu-preview">
                            <div class="context-target">
                                <span class="target-text">Right-click me!</span>
                                <span class="context-hint">?? Context menu appears here</span>
                            </div>
                            
                            <div class="context-menu visible">
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Edit</span>
                                    <span class="context-shortcut">Ctrl+E</span>
                                </div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Copy</span>
                                    <span class="context-shortcut">Ctrl+C</span>
                                </div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Paste</span>
                                    <span class="context-shortcut">Ctrl+V</span>
                                </div>
                                <div class="context-separator"></div>
                                <div class="context-item">
                                    <span class="context-icon">???</span>
                                    <span class="context-text">Delete</span>
                                    <span class="context-shortcut">Del</span>
                                </div>
                                <div class="context-separator"></div>
                                <div class="context-item submenu">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Send To</span>
                                    <span class="context-arrow">?</span>
                                </div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Properties</span>
                                    <span class="context-shortcut">Alt+Enter</span>
                                </div>
                            </div>
                        </div>
                        <p><em>BeepPopupListFormStrip showing common contextual actions with icons and shortcuts</em></p>
                    </div>

                    <h3>Data Grid Context Menu</h3>
                    <div class="visual-demo">
                        <div class="data-grid-context">
                            <div class="data-grid">
                                <div class="grid-header">
                                    <div class="grid-cell">Name</div>
                                    <div class="grid-cell">Email</div>
                                    <div class="grid-cell">Status</div>
                                </div>
                                <div class="grid-row selected">
                                    <div class="grid-cell">John Smith</div>
                                    <div class="grid-cell">john@example.com</div>
                                    <div class="grid-cell">Active</div>
                                </div>
                                <div class="grid-row">
                                    <div class="grid-cell">Jane Doe</div>
                                    <div class="grid-cell">jane@example.com</div>
                                    <div class="grid-cell">Inactive</div>
                                </div>
                            </div>
                            
                            <div class="context-menu data-menu visible">
                                <div class="context-item">
                                    <span class="context-icon">???</span>
                                    <span class="context-text">View Details</span>
                                </div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Edit Record</span>
                                </div>
                                <div class="context-separator"></div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Send Email</span>
                                </div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Call Contact</span>
                                </div>
                                <div class="context-separator"></div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Generate Report</span>
                                </div>
                                <div class="context-item">
                                    <span class="context-icon">??</span>
                                    <span class="context-text">Export Data</span>
                                </div>
                                <div class="context-separator"></div>
                                <div class="context-item danger">
                                    <span class="context-icon">???</span>
                                    <span class="context-text">Delete Record</span>
                                </div>
                            </div>
                        </div>
                        <p><em>Data-centric context menu with record-specific operations and visual grouping</em></p>
                    </div>

                    <style>
                        .visual-demo {
                            border: 2px dashed var(--color-border-light);
                            border-radius: 8px;
                            padding: 2rem;
                            text-align: center;
                            margin: 1rem 0;
                            background: var(--color-background-secondary);
                        }

                        .context-menu-preview,
                        .data-grid-context {
                            position: relative;
                            background: var(--color-background);
                            border: 1px solid var(--color-border);
                            border-radius: 12px;
                            padding: 2rem;
                            text-align: left;
                            margin: 0 auto;
                            max-width: 600px;
                            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
                            font-family: var(--font-family);
                        }

                        .context-target {
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            height: 120px;
                            background: var(--color-background-secondary);
                            border: 2px dashed var(--color-border);
                            border-radius: 8px;
                            margin-bottom: 1rem;
                            cursor: pointer;
                            transition: all 0.2s ease;
                        }

                        .context-target:hover {
                            background: var(--color-primary-light);
                            border-color: var(--color-primary);
                        }

                        .target-text {
                            font-size: 16px;
                            font-weight: 600;
                            color: var(--color-text);
                            margin-bottom: 0.5rem;
                        }

                        .context-hint {
                            font-size: 12px;
                            color: var(--color-text-secondary);
                        }

                        .context-menu {
                            position: absolute;
                            top: 60%;
                            right: 20px;
                            background: var(--color-background);
                            border: 1px solid var(--color-border);
                            border-radius: 8px;
                            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
                            min-width: 200px;
                            padding: 4px 0;
                            z-index: 1000;
                            opacity: 0;
                            visibility: hidden;
                            transform: translateY(-10px) scale(0.95);
                            transition: all 0.2s ease;
                        }

                        .context-menu.visible {
                            opacity: 1;
                            visibility: visible;
                            transform: translateY(0) scale(1);
                        }

                        .context-menu.data-menu {
                            top: 40%;
                            right: 10px;
                            min-width: 180px;
                        }

                        .context-item {
                            display: flex;
                            align-items: center;
                            gap: 0.75rem;
                            padding: 8px 16px;
                            cursor: pointer;
                            transition: background-color 0.2s ease;
                            user-select: none;
                        }

                        .context-item:hover {
                            background: var(--color-background-secondary);
                        }

                        .context-item.danger:hover {
                            background: #fee;
                            color: #d32f2f;
                        }

                        .context-item.submenu {
                            position: relative;
                        }

                        .context-icon {
                            font-size: 14px;
                            width: 16px;
                            text-align: center;
                            flex-shrink: 0;
                        }

                        .context-text {
                            flex: 1;
                            font-size: 13px;
                            color: var(--color-text);
                        }

                        .context-shortcut {
                            font-size: 11px;
                            color: var(--color-text-secondary);
                            margin-left: auto;
                            font-family: monospace;
                        }

                        .context-arrow {
                            font-size: 10px;
                            color: var(--color-text-secondary);
                            margin-left: auto;
                        }

                        .context-separator {
                            height: 1px;
                            background: var(--color-border-light);
                            margin: 4px 8px;
                        }

                        .data-grid {
                            border: 1px solid var(--color-border);
                            border-radius: 6px;
                            overflow: hidden;
                            margin-bottom: 1rem;
                        }

                        .grid-header {
                            display: grid;
                            grid-template-columns: 1fr 2fr 1fr;
                            background: var(--color-background-secondary);
                            border-bottom: 1px solid var(--color-border);
                        }

                        .grid-row {
                            display: grid;
                            grid-template-columns: 1fr 2fr 1fr;
                            border-bottom: 1px solid var(--color-border-light);
                            transition: background-color 0.2s ease;
                        }

                        .grid-row:hover {
                            background: var(--color-background-secondary);
                        }

                        .grid-row.selected {
                            background: var(--color-primary-light);
                            border-color: var(--color-primary);
                        }

                        .grid-cell {
                            padding: 0.75rem;
                            font-size: 13px;
                            border-right: 1px solid var(--color-border-light);
                        }

                        .grid-cell:last-child {
                            border-right: none;
                        }

                        .grid-header .grid-cell {
                            font-weight: 600;
                            color: var(--color-text);
                        }
                    </style>
                </section>

                <!-- Basic Usage -->
                <section id="basic-usage" class="section">
                    <h2>Basic Usage</h2>
                    
                    <div class="code-example">
                        <h3>Simple Context Menu</h3>
                        <pre><code class="language-csharp">// Create a BeepPopupListFormStrip
var contextMenu = new BeepPopupListFormStrip();

// Add menu items
contextMenu.ListItems.Add(new SimpleItem
{
    Text = "Edit",
    ImagePath = "edit-icon.svg",
    GuidId = Guid.NewGuid().ToString()
});

contextMenu.ListItems.Add(new SimpleItem
{
    Text = "Copy",
    ImagePath = "copy-icon.svg",
    GuidId = Guid.NewGuid().ToString()
});

contextMenu.ListItems.Add(new SimpleItem
{
    Text = "-", // Separator
    IsSeparator = true,
    GuidId = Guid.NewGuid().ToString()
});

contextMenu.ListItems.Add(new SimpleItem
{
    Text = "Delete",
    ImagePath = "delete-icon.svg",
    GuidId = Guid.NewGuid().ToString()
});

// Handle item clicks
contextMenu.ItemClicked += (sender, item) =>
{
    switch (item.Text)
    {
        case "Edit":
            EditSelectedItem();
            break;
        case "Copy":
            CopySelectedItem();
            break;
        case "Delete":
            DeleteSelectedItem();
            break;
    }
};

// Show context menu on right-click
someControl.MouseDown += (sender, e) =>
{
    if (e.Button == MouseButtons.Right)
    {
        var screenLocation = someControl.PointToScreen(e.Location);
        contextMenu.Show(screenLocation);
    }
};</code></pre>
                    </div>

                    <div class="code-example">
                        <h3>Data Grid Context Menu</h3>
                        <pre><code class="language-csharp">public void SetupDataGridContextMenu(DataGridView dataGrid)
{
    var contextMenu = new BeepPopupListFormStrip();

    // Build context menu items
    var menuItems = new[]
    {
        new SimpleItem { Text = "View Details", ImagePath = "view-icon.svg", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Edit Record", ImagePath = "edit-icon.svg", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Send Email", ImagePath = "email-icon.svg", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Call Contact", ImagePath = "phone-icon.svg", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Export Data", ImagePath = "export-icon.svg", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Generate Report", ImagePath = "report-icon.svg", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Delete Record", ImagePath = "delete-icon.svg", GuidId = Guid.NewGuid().ToString() }
    };

    foreach (var item in menuItems)
    {
        contextMenu.ListItems.Add(item);
    }

    // Handle context menu actions
    contextMenu.ItemClicked += (sender, item) =>
    {
        if (dataGrid.SelectedRows.Count == 0) return;

        var selectedRow = dataGrid.SelectedRows[0];
        
        switch (item.Text)
        {
            case "View Details":
                ShowRecordDetails(selectedRow);
                break;
            case "Edit Record":
                EditRecord(selectedRow);
                break;
            case "Send Email":
                SendEmailToContact(selectedRow);
                break;
            case "Call Contact":
                InitiatePhoneCall(selectedRow);
                break;
            case "Export Data":
                ExportRowData(selectedRow);
                break;
            case "Generate Report":
                GenerateRecordReport(selectedRow);
                break;
            case "Delete Record":
                DeleteRecord(selectedRow);
                break;
        }
    };

    // Attach to data grid
    dataGrid.MouseDown += (sender, e) =>
    {
        if (e.Button == MouseButtons.Right)
        {
            var hitTest = dataGrid.HitTest(e.X, e.Y);
            if (hitTest.RowIndex >= 0)
            {
                // Select the row that was right-clicked
                dataGrid.ClearSelection();
                dataGrid.Rows[hitTest.RowIndex].Selected = true;

                // Show context menu
                var screenLocation = dataGrid.PointToScreen(e.Location);
                contextMenu.Show(screenLocation);
            }
        }
    };
}</code></pre>
                    </div>

                    <div class="code-example">
                        <h3>Control Integration Pattern</h3>
                        <pre><code class="language-csharp">public class ContextMenuProvider
{
    private readonly Dictionary<Type, BeepPopupListFormStrip> contextMenus;

    public ContextMenuProvider()
    {
        contextMenus = new Dictionary<Type, BeepPopupListFormStrip>();
        InitializeContextMenus();
    }

    private void InitializeContextMenus()
    {
        // Text control context menu
        var textContextMenu = CreateTextContextMenu();
        contextMenus[typeof(TextBox)] = textContextMenu;
        contextMenus[typeof(BeepTextBox)] = textContextMenu;

        // Image control context menu
        var imageContextMenu = CreateImageContextMenu();
        contextMenus[typeof(PictureBox)] = imageContextMenu;
        contextMenus[typeof(BeepImage)] = imageContextMenu;

        // List control context menu
        var listContextMenu = CreateListContextMenu();
        contextMenus[typeof(ListBox)] = listContextMenu;
        contextMenus[typeof(BeepListBox)] = listContextMenu;
    }

    private BeepPopupListFormStrip CreateTextContextMenu()
    {
        var menu = new BeepPopupListFormStrip();
        
        menu.ListItems.AddRange(new[]
        {
            new SimpleItem { Text = "Cut", ImagePath = "cut.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Copy", ImagePath = "copy.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Paste", ImagePath = "paste.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Select All", ImagePath = "select-all.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Find", ImagePath = "search.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Replace", ImagePath = "replace.svg", GuidId = Guid.NewGuid().ToString() }
        });

        menu.ItemClicked += (sender, item) =>
        {
            var activeControl = GetActiveTextControl();
            if (activeControl == null) return;

            switch (item.Text)
            {
                case "Cut":
                    if (activeControl is TextBoxBase textBox)
                        textBox.Cut();
                    break;
                case "Copy":
                    if (activeControl is TextBoxBase tb)
                        tb.Copy();
                    break;
                case "Paste":
                    if (activeControl is TextBoxBase tbPaste)
                        tbPaste.Paste();
                    break;
                case "Select All":
                    if (activeControl is TextBoxBase tbSelect)
                        tbSelect.SelectAll();
                    break;
                case "Find":
                    ShowFindDialog(activeControl);
                    break;
                case "Replace":
                    ShowReplaceDialog(activeControl);
                    break;
            }
        };

        return menu;
    }

    private BeepPopupListFormStrip CreateImageContextMenu()
    {
        var menu = new BeepPopupListFormStrip();
        
        menu.ListItems.AddRange(new[]
        {
            new SimpleItem { Text = "Copy Image", ImagePath = "copy.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Save Image As...", ImagePath = "save.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Zoom In", ImagePath = "zoom-in.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Zoom Out", ImagePath = "zoom-out.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Actual Size", ImagePath = "zoom-actual.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Properties", ImagePath = "properties.svg", GuidId = Guid.NewGuid().ToString() }
        });

        menu.ItemClicked += (sender, item) =>
        {
            var activeImage = GetActiveImageControl();
            if (activeImage == null) return;

            switch (item.Text)
            {
                case "Copy Image":
                    CopyImageToClipboard(activeImage);
                    break;
                case "Save Image As...":
                    SaveImageAs(activeImage);
                    break;
                case "Zoom In":
                    ZoomImage(activeImage, 1.2f);
                    break;
                case "Zoom Out":
                    ZoomImage(activeImage, 0.8f);
                    break;
                case "Actual Size":
                    ResetImageZoom(activeImage);
                    break;
                case "Properties":
                    ShowImageProperties(activeImage);
                    break;
            }
        };

        return menu;
    }

    public void AttachContextMenu(Control control)
    {
        if (contextMenus.TryGetValue(control.GetType(), out var contextMenu))
        {
            control.MouseDown += (sender, e) =>
            {
                if (e.Button == MouseButtons.Right)
                {
                    var screenLocation = control.PointToScreen(e.Location);
                    contextMenu.Show(screenLocation);
                }
            };
        }
    }

    // Helper methods
    private Control GetActiveTextControl() => Form.ActiveForm?.ActiveControl as TextBoxBase;
    private Control GetActiveImageControl() => Form.ActiveForm?.ActiveControl as PictureBox;
    private void ShowFindDialog(Control control) { /* Implementation */ }
    private void ShowReplaceDialog(Control control) { /* Implementation */ }
    private void CopyImageToClipboard(Control imageControl) { /* Implementation */ }
    private void SaveImageAs(Control imageControl) { /* Implementation */ }
    private void ZoomImage(Control imageControl, float factor) { /* Implementation */ }
    private void ResetImageZoom(Control imageControl) { /* Implementation */ }
    private void ShowImageProperties(Control imageControl) { /* Implementation */ }
}</code></pre>
                    </div>
                </section>

                <!-- Properties -->
                <section id="properties" class="section">
                    <h2>Properties</h2>

                    <h3>Inherited from BeepListBox</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>ListItems</code></td>
                                <td>BindingList&lt;SimpleItem&gt;</td>
                                <td>Collection of context menu items</td>
                            </tr>
                            <tr>
                                <td><code>ShowCheckBox</code></td>
                                <td>bool</td>
                                <td>Whether to show checkboxes (default: false for context menus)</td>
                            </tr>
                            <tr>
                                <td><code>SelectedIndex</code></td>
                                <td>int</td>
                                <td>Index of currently selected item</td>
                            </tr>
                            <tr>
                                <td><code>SelectedItem</code></td>
                                <td>SimpleItem</td>
                                <td>Currently selected menu item</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Context Menu Specific</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>PopupForm</code></td>
                                <td>BeepPopupForm</td>
                                <td>Internal popup form hosting the context menu</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>SimpleItem Structure</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>Text</code></td>
                                <td>string</td>
                                <td>Display text for the menu item</td>
                            </tr>
                            <tr>
                                <td><code>ImagePath</code></td>
                                <td>string</td>
                                <td>Path to icon image file</td>
                            </tr>
                            <tr>
                                <td><code>IsSeparator</code></td>
                                <td>bool</td>
                                <td>Whether the item is a visual separator (Text = "-")</td>
                            </tr>
                            <tr>
                                <td><code>GuidId</code></td>
                                <td>string</td>
                                <td>Unique identifier for the menu item</td>
                            </tr>
                            <tr>
                                <td><code>Tag</code></td>
                                <td>object</td>
                                <td>Additional data associated with the item</td>
                            </tr>
                            <tr>
                                <td><code>Enabled</code></td>
                                <td>bool</td>
                                <td>Whether the menu item is enabled</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Events -->
                <section id="events" class="section">
                    <h2>Events</h2>

                    <h3>Context Menu Events</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Event Args</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>ItemClicked</code></td>
                                <td>EventHandler&lt;SimpleItem&gt;</td>
                                <td>Fired when a context menu item is clicked</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Inherited Events from BeepListBox</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Event Args</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>SelectedItemChanged</code></td>
                                <td>EventHandler</td>
                                <td>Fired when the selected item changes</td>
                            </tr>
                            <tr>
                                <td><code>ListItemClicked</code></td>
                                <td>Override method</td>
                                <td>Handles individual item clicks from BeepButton controls</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Examples -->
                <section id="examples" class="section">
                    <h2>Examples</h2>

                    <div class="code-example">
                        <h3>Tree View Context Menu</h3>
                        <pre><code class="language-csharp">public void SetupTreeViewContextMenu(TreeView treeView)
{
    var contextMenu = new BeepPopupListFormStrip();

    // Node-specific menu items that change based on node type
    contextMenu.ItemClicked += (sender, item) =>
    {
        if (treeView.SelectedNode == null) return;

        var node = treeView.SelectedNode;
        
        switch (item.Text)
        {
            case "Add Child":
                AddChildNode(node);
                break;
            case "Edit":
                EditNode(node);
                break;
            case "Delete":
                DeleteNode(node);
                break;
            case "Expand All":
                node.ExpandAll();
                break;
            case "Collapse All":
                node.Collapse();
                break;
            case "Properties":
                ShowNodeProperties(node);
                break;
        }
    };

    // Build context menu dynamically based on selected node
    treeView.MouseDown += (sender, e) =>
    {
        if (e.Button == MouseButtons.Right)
        {
            var node = treeView.GetNodeAt(e.X, e.Y);
            if (node != null)
            {
                treeView.SelectedNode = node;
                
                // Clear existing items
                contextMenu.ListItems.Clear();

                // Add items based on node type/level
                if (node.Level == 0) // Root node
                {
                    contextMenu.ListItems.AddRange(new[]
                    {
                        new SimpleItem { Text = "Add Child", ImagePath = "add.svg", GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "Expand All", ImagePath = "expand.svg", GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "Collapse All", ImagePath = "collapse.svg", GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "Properties", ImagePath = "properties.svg", GuidId = Guid.NewGuid().ToString() }
                    });
                }
                else // Child nodes
                {
                    contextMenu.ListItems.AddRange(new[]
                    {
                        new SimpleItem { Text = "Add Child", ImagePath = "add.svg", GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "Edit", ImagePath = "edit.svg", GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "Delete", ImagePath = "delete.svg", GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
                        new SimpleItem { Text = "Properties", ImagePath = "properties.svg", GuidId = Guid.NewGuid().ToString() }
                    });
                }

                // Show context menu
                var screenLocation = treeView.PointToScreen(e.Location);
                contextMenu.Show(screenLocation);
            }
        }
    };
}

private void AddChildNode(TreeNode parentNode)
{
    var newNode = new TreeNode("New Node");
    parentNode.Nodes.Add(newNode);
    parentNode.Expand();
    // Begin edit mode
    newNode.BeginEdit();
}

private void EditNode(TreeNode node)
{
    node.BeginEdit();
}

private void DeleteNode(TreeNode node)
{
    if (MessageBox.Show($"Delete '{node.Text}'?", "Confirm Delete", 
        MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.Yes)
    {
        node.Remove();
    }
}

private void ShowNodeProperties(TreeNode node)
{
    var properties = new Dictionary<string, object>
    {
        ["Text"] = node.Text,
        ["Level"] = node.Level,
        ["Index"] = node.Index,
        ["Children"] = node.Nodes.Count,
        ["Tag"] = node.Tag?.ToString() ?? "None"
    };

    // Show properties dialog
    var propertiesForm = new NodePropertiesForm(properties);
    propertiesForm.ShowDialog();
}</code></pre>
                    </div>

                    <div class="code-example">
                        <h3>File Explorer Context Menu</h3>
                        <pre><code class="language-csharp">public class FileExplorerContextMenu
{
    private BeepPopupListFormStrip fileContextMenu;
    private BeepPopupListFormStrip folderContextMenu;
    private BeepPopupListFormStrip emptySpaceContextMenu;

    public FileExplorerContextMenu()
    {
        InitializeContextMenus();
    }

    private void InitializeContextMenus()
    {
        // File context menu
        fileContextMenu = new BeepPopupListFormStrip();
        fileContextMenu.ListItems.AddRange(new[]
        {
            new SimpleItem { Text = "Open", ImagePath = "open.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Open With", ImagePath = "open-with.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Cut", ImagePath = "cut.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Copy", ImagePath = "copy.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Delete", ImagePath = "delete.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Rename", ImagePath = "rename.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Properties", ImagePath = "properties.svg", GuidId = Guid.NewGuid().ToString() }
        });

        // Folder context menu
        folderContextMenu = new BeepPopupListFormStrip();
        folderContextMenu.ListItems.AddRange(new[]
        {
            new SimpleItem { Text = "Open", ImagePath = "open.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Open in New Window", ImagePath = "new-window.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Cut", ImagePath = "cut.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Copy", ImagePath = "copy.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Delete", ImagePath = "delete.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Rename", ImagePath = "rename.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Properties", ImagePath = "properties.svg", GuidId = Guid.NewGuid().ToString() }
        });

        // Empty space context menu
        emptySpaceContextMenu = new BeepPopupListFormStrip();
        emptySpaceContextMenu.ListItems.AddRange(new[]
        {
            new SimpleItem { Text = "New", ImagePath = "new.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Paste", ImagePath = "paste.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Refresh", ImagePath = "refresh.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "View", ImagePath = "view.svg", GuidId = Guid.NewGuid().ToString() },
            new SimpleItem { Text = "Sort By", ImagePath = "sort.svg", GuidId = Guid.NewGuid().ToString() }
        });

        // Wire up events
        fileContextMenu.ItemClicked += (s, item) => HandleFileAction(item);
        folderContextMenu.ItemClicked += (s, item) => HandleFolderAction(item);
        emptySpaceContextMenu.ItemClicked += (s, item) => HandleEmptySpaceAction(item);
    }

    public void AttachToListView(ListView listView)
    {
        listView.MouseDown += (sender, e) =>
        {
            if (e.Button == MouseButtons.Right)
            {
                var item = listView.GetItemAt(e.X, e.Y);
                var screenLocation = listView.PointToScreen(e.Location);

                if (item != null)
                {
                    // Select the item
                    listView.SelectedItems.Clear();
                    item.Selected = true;

                    // Show appropriate context menu based on item type
                    var isFolder = (bool)(item.Tag ?? false);
                    if (isFolder)
                    {
                        folderContextMenu.Show(screenLocation);
                    }
                    else
                    {
                        fileContextMenu.Show(screenLocation);
                    }
                }
                else
                {
                    // Right-clicked on empty space
                    emptySpaceContextMenu.Show(screenLocation);
                }
            }
        };
    }

    private void HandleFileAction(SimpleItem item)
    {
        switch (item.Text)
        {
            case "Open":
                OpenSelectedFile();
                break;
            case "Open With":
                ShowOpenWithDialog();
                break;
            case "Cut":
                CutSelectedItems();
                break;
            case "Copy":
                CopySelectedItems();
                break;
            case "Delete":
                DeleteSelectedItems();
                break;
            case "Rename":
                RenameSelectedItem();
                break;
            case "Properties":
                ShowFileProperties();
                break;
        }
    }

    private void HandleFolderAction(SimpleItem item)
    {
        switch (item.Text)
        {
            case "Open":
                OpenSelectedFolder();
                break;
            case "Open in New Window":
                OpenFolderInNewWindow();
                break;
            // ... other folder actions
        }
    }

    private void HandleEmptySpaceAction(SimpleItem item)
    {
        switch (item.Text)
        {
            case "New":
                ShowNewItemMenu();
                break;
            case "Paste":
                PasteItems();
                break;
            case "Refresh":
                RefreshView();
                break;
            // ... other empty space actions
        }
    }

    // Implementation methods
    private void OpenSelectedFile() { /* Implementation */ }
    private void ShowOpenWithDialog() { /* Implementation */ }
    private void CutSelectedItems() { /* Implementation */ }
    private void CopySelectedItems() { /* Implementation */ }
    private void DeleteSelectedItems() { /* Implementation */ }
    private void RenameSelectedItem() { /* Implementation */ }
    private void ShowFileProperties() { /* Implementation */ }
    private void OpenSelectedFolder() { /* Implementation */ }
    private void OpenFolderInNewWindow() { /* Implementation */ }
    private void ShowNewItemMenu() { /* Implementation */ }
    private void PasteItems() { /* Implementation */ }
    private void RefreshView() { /* Implementation */ }
}</code></pre>
                    </div>
                </section>

                <!-- Theming -->
                <section id="theming" class="section">
                    <h2>Theming</h2>
                    
                    <p>BeepPopupListFormStrip inherits full theming capabilities from BeepListBox with additional popup-specific styling:</p>

                    <div class="code-example">
                        <h3>Theme Application</h3>
                        <pre><code class="language-csharp">var contextMenu = new BeepPopupListFormStrip
{
    Theme = "DarkTheme"
};

// Theme automatically applies to:
// - Menu item backgrounds and text
// - Hover and selection states
// - Border and separator colors
// - Popup form background
// - Icon color adjustments

// Manual theme refresh
contextMenu.ApplyTheme();</code></pre>
                    </div>

                    <h3>Context Menu Theming Properties</h3>
                    <ul>
                        <li><strong>PanelBackColor</strong> - Context menu background</li>
                        <li><strong>ButtonBackColor</strong> - Menu item backgrounds</li>
                        <li><strong>ButtonForeColor</strong> - Menu item text color</li>
                        <li><strong>ButtonHoverBackColor</strong> - Hover state background</li>
                        <li><strong>ButtonSelectedBackColor</strong> - Selected item background</li>
                        <li><strong>BorderColor</strong> - Menu border and separators</li>
                        <li><strong>ShadowColor</strong> - Drop shadow effects</li>
                    </ul>

                    <div class="code-example">
                        <h3>Custom Popup Styling</h3>
                        <pre><code class="language-csharp">// Override ApplyTheme for custom popup styling
public class CustomContextMenuStrip : BeepPopupListFormStrip
{
    public override void ApplyTheme()
    {
        base.ApplyTheme();
        
        if (popupForm != null && _currentTheme != null)
        {
            // Custom popup form styling
            popupForm.BackColor = _currentTheme.PanelBackColor;
            popupForm.Opacity = 0.98; // Slight transparency
            
            // Add custom shadow effects
            if (_currentTheme.ShowShadow)
            {
                popupForm.DropShadow = true;
                popupForm.ShadowDepth = 8;
            }
        }
    }
}</code></pre>
                    </div>
                </section>

                <!-- Best Practices -->
                <section id="best-practices" class="section">
                    <h2>Best Practices</h2>

                    <h3>??? User Experience</h3>
                    <ul>
                        <li><strong>Context awareness:</strong> Show only relevant actions for the selected item/context</li>
                        <li><strong>Logical grouping:</strong> Use separators to group related menu items</li>
                        <li><strong>Clear icons:</strong> Use intuitive icons that match the action being performed</li>
                        <li><strong>Keyboard shortcuts:</strong> Display keyboard shortcuts for common actions</li>
                    </ul>

                    <h3>?? Positioning & Behavior</h3>
                    <ul>
                        <li><strong>Screen boundaries:</strong> Ensure context menus stay within screen bounds</li>
                        <li><strong>Quick access:</strong> Keep frequently used actions at the top of the menu</li>
                        <li><strong>Auto-hide:</strong> Close menus when clicking outside or pressing Escape</li>
                        <li><strong>Selection feedback:</strong> Provide clear visual feedback for menu item selection</li>
                    </ul>

                    <h3>?? Implementation</h3>
                    <ul>
                        <li><strong>Dynamic menus:</strong> Build menu contents based on current context/selection</li>
                        <li><strong>State management:</strong> Enable/disable menu items based on current state</li>
                        <li><strong>Error handling:</strong> Gracefully handle menu actions that might fail</li>
                        <li><strong>Memory management:</strong> Properly dispose of popup forms and resources</li>
                    </ul>

                    <h3>? Performance</h3>
                    <ul>
                        <li><strong>Lazy creation:</strong> Create context menus only when needed</li>
                        <li><strong>Reuse menus:</strong> Reuse context menu instances where appropriate</li>
                        <li><strong>Efficient updates:</strong> Update menu contents efficiently without recreation</li>
                        <li><strong>Resource cleanup:</strong> Dispose of unused menu resources properly</li>
                    </ul>

                    <div class="tip">
                        <strong>?? Design Tip</strong>
                        <p>Keep context menus focused and concise. More than 10-12 items can overwhelm users - consider using submenus for complex actions.</p>
                    </div>

                    <div class="success">
                        <strong>? Best Practice</strong>
                        <p>Always handle the ItemClicked event to provide immediate feedback and action execution when menu items are selected.</p>
                    </div>

                    <div class="warning">
                        <strong>?? Memory Warning</strong>
                        <p>Ensure proper disposal of BeepPopupForm instances to prevent memory leaks, especially in applications with frequent context menu usage.</p>
                    </div>
                </section>

                <!-- Navigation -->
                <div class="nav-links">
                    <a href="beep-sidemenu.html"><i class="bi bi-arrow-left"></i> BeepSideMenu</a>
                    <a href="beep-dropdownmenu.html">BeepDropDownMenu <i class="bi bi-arrow-right"></i></a>
                </div>

                <!-- Footer -->
                <footer class="documentation-footer">
                    <div class="footer-content">
                        <div class="footer-copyright">
                            <p>&copy; 2024 TheTechIdea - Beep Controls Documentation</p>
                            <p>Supporting .NET 6, 7, 8, and 9 | Windows Forms Applications</p>
                        </div>
                        <div class="footer-links">
                            <a href="../index.html">Home</a>
                            <a href="../getting-started/installation.html">Getting Started</a>
                            <a href="../api/beep-control-base.html">API Reference</a>
                        </div>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const submenus = document.querySelectorAll('.has-submenu > a');
            submenus.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const parent = this.parentElement;
                    parent.classList.toggle('open');
                });
            });
        });

        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = body.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
                themeIcon.className = 'bi bi-sun-fill';
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.className = 'bi bi-moon-fill';
                localStorage.setItem('theme', 'dark');
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        function searchDocs(query) {
            const links = document.querySelectorAll('.nav-menu a');
            const lowerQuery = query.toLowerCase();
            
            links.forEach(link => {
                const text = link.textContent.toLowerCase();
                const listItem = link.closest('li');
                
                if (text.includes(lowerQuery) || lowerQuery === '') {
                    listItem.style.display = '';
                } else {
                    listItem.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>