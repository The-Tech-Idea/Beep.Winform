<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeepMenuBar - Beep Controls Documentation</title>
    <link rel="stylesheet" href="../sphinx-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>

<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <img src="../assets/beep-logo.svg" alt="Beep Controls Logo">
                <div class="logo-text">
                    <h2>Beep Controls</h2>
                    <span class="version">v1.0.164</span>
                </div>
            </div>

            <!-- Search -->
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search documentation..." onkeyup="searchDocs(this.value)">
            </div>

            <nav>
                <ul class="nav-menu">
                    <li><a href="../index.html"><i class="bi bi-house"></i> Home</a></li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-rocket"></i> Getting Started</a>
                        <ul class="submenu">
                            <li><a href="../getting-started/installation.html">Installation Guide</a></li>
                            <li><a href="../getting-started/quick-start.html">Quick Start Tutorial</a></li>
                            <li><a href="../getting-started/theming.html">Theming System</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-input-cursor-text"></i> Input Controls</a>
                        <ul class="submenu">
                            <li><a href="beep-button.html">BeepButton</a></li>
                            <li><a href="beep-textbox.html">BeepTextBox</a></li>
                            <li><a href="beep-combobox.html">BeepComboBox</a></li>
                            <li><a href="beep-checkbox.html">BeepCheckBox</a></li>
                            <li><a href="beep-radiobutton.html">BeepRadioButton</a></li>
                            <li><a href="beep-datepicker.html">BeepDatePicker</a></li>
                            <li><a href="beep-numericupdown.html">BeepNumericUpDown</a></li>
                            <li><a href="beep-switch.html">BeepSwitch</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-display"></i> Display Controls</a>
                        <ul class="submenu">
                            <li><a href="beep-label.html">BeepLabel</a></li>
                            <li><a href="beep-image.html">BeepImage</a></li>
                            <li><a href="beep-progressbar.html">BeepProgressBar</a></li>
                            <li><a href="beep-shape.html">BeepShape</a></li>
                            <li><a href="beep-starrating.html">BeepStarRating</a></li>
                            <li><a href="beep-marquee.html">BeepMarquee</a></li>
                            <li><a href="beep-testimonial.html">BeepTestimonial</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-layout-split"></i> Layout Controls</a>
                        <ul class="submenu">
                            <li><a href="beep-panel.html">BeepPanel</a></li>
                            <li><a href="beep-card.html">BeepCard</a></li>
                            <li><a href="beep-tabcontrol.html">BeepTabs</a></li>
                            <li><a href="beep-accordion.html">BeepAccordionMenu</a></li>
                            <li><a href="beep-multisplitter.html">BeepMultiSplitter</a></li>
                            <li><a href="beep-breadcrumps.html">BeepBreadcrumps</a></li>
                            <li><a href="beep-stepper.html">BeepSteppperBar</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-bar-chart"></i> Data Controls</a>
                        <ul class="submenu">
                            <li><a href="beep-grid.html">BeepSimpleGrid</a></li>
                            <li><a href="beep-chart.html">BeepChart</a></li>
                            <li><a href="beep-statcard.html">BeepStatCard</a></li>
                            <li><a href="beep-metrictile.html">BeepMetricTile</a></li>
                            <li><a href="beep-datanavigator.html">BeepDataNavigator</a></li>
                            <li><a href="beep-filter.html">BeepFilter</a></li>
                            <li><a href="beep-tree.html">BeepTree</a></li>
                            <li><a href="beep-listbox.html">BeepListBox</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu open">
                        <a href="#"><i class="bi bi-tools"></i> Specialized Controls</a>
                        <ul class="submenu">
                            <li><a href="beep-menubar.html" class="active">BeepMenuBar</a></li>
                            <li><a href="beep-toolstrip.html">BeepToolStrip</a></li>
                            <li><a href="beep-appbar.html">BeepAppBar</a></li>
                            <li><a href="beep-sidemenu.html">BeepSideMenu</a></li>
                            <li><a href="beep-login.html">BeepLogin</a></li>
                            <li><a href="beep-wizard.html">BeepWizard</a></li>
                            <li><a href="beep-calendar.html">BeepCalendarView</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a href="#"><i class="bi bi-chat-square"></i> Dialogs & Popups</a>
                        <ul class="submenu">
                            <li><a href="beep-dialogbox.html">BeepDialogBox</a></li>
                            <li><a href="beep-popup.html">BeepPopupForm</a></li>
                            <li><a href="beep-filedialog.html">BeepFileDialog</a></li>
                            <li><a href="beep-wait.html">BeepWait</a></li>
                            <li><a href="beep-splash.html">BeepSplashScreen</a></li>
                        </ul>
                    </li>
                    <li><a href="../api/beep-control-base.html"><i class="bi bi-code-square"></i> API Reference</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb-nav">
                    <a href="../index.html">Home</a>
                    <span>›</span>
                    <a href="../index.html#specialized-controls">Specialized Controls</a>
                    <span>›</span>
                    <span>BeepMenuBar</span>
                </nav>

                <!-- Page Header -->
                <div class="page-header">
                    <h1>BeepMenuBar</h1>
                    <p class="page-subtitle">Professional application menu bar with hierarchical menus and popup support</p>
                </div>

                <!-- Table of Contents -->
                <div class="toc">
                    <h3>?? Table of Contents</h3>
                    <ul>
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#features">Key Features</a></li>
                        <li><a href="#visual-preview">Visual Preview</a></li>
                        <li><a href="#basic-usage">Basic Usage</a></li>
                        <li><a href="#properties">Properties</a></li>
                        <li><a href="#events">Events</a></li>
                        <li><a href="#examples">Examples</a></li>
                        <li><a href="#theming">Theming</a></li>
                        <li><a href="#best-practices">Best Practices</a></li>
                    </ul>
                </div>

                <!-- Overview -->
                <section id="overview" class="section">
                    <h2>Overview</h2>
                    <p>
                        <strong>BeepMenuBar</strong> is a sophisticated application menu bar control that provides 
                        traditional desktop application navigation with modern styling and features. It supports 
                        hierarchical menu structures, popup menus, custom icons, and seamless integration with 
                        application functionality through method binding.
                    </p>
                    <p>
                        Built on the <strong>BeepControl</strong> foundation, BeepMenuBar features automatic layout, 
                        intelligent sizing, popup management, theme integration, and support for complex menu 
                        hierarchies. Perfect for desktop applications, administrative interfaces, and professional 
                        software requiring traditional menu navigation.
                    </p>
                </section>

                <!-- Key Features -->
                <section id="features" class="section">
                    <h2>Key Features</h2>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3>?? Hierarchical Menus</h3>
                            <p>Support for multi-level menu structures with nested submenus and separators</p>
                        </div>
                        <div class="feature-card">
                            <h3>??? Icon Integration</h3>
                            <p>Custom icons for menu items with automatic sizing and theme-aware coloring</p>
                        </div>
                        <div class="feature-card">
                            <h3>?? Smart Layout</h3>
                            <p>Automatic button sizing and positioning with preferred size calculation</p>
                        </div>
                        <div class="feature-card">
                            <h3>?? Popup Management</h3>
                            <p>Advanced popup form handling with state tracking and automatic cleanup</p>
                        </div>
                        <div class="feature-card">
                            <h3>? Method Binding</h3>
                            <p>Direct method execution through global function handlers and dependency injection</p>
                        </div>
                        <div class="feature-card">
                            <h3>?? Theme Integration</h3>
                            <p>Complete theme support with menu-specific styling and hover effects</p>
                        </div>
                    </div>
                </section>

                <!-- Visual Preview -->
                <section id="visual-preview" class="section">
                    <h2>Visual Preview</h2>
                    
                    <div class="visual-demo">
                        <div class="menubar-preview">
                            
                            <!-- Main Menu Bar -->
                            <div class="menubar-container">
                                <div class="menu-item active">
                                    <span class="menu-icon">??</span>
                                    <span class="menu-text">File</span>
                                </div>
                                <div class="menu-item">
                                    <span class="menu-icon">??</span>
                                    <span class="menu-text">Edit</span>
                                </div>
                                <div class="menu-item">
                                    <span class="menu-icon">???</span>
                                    <span class="menu-text">View</span>
                                </div>
                                <div class="menu-item">
                                    <span class="menu-icon">??</span>
                                    <span class="menu-text">Tools</span>
                                </div>
                                <div class="menu-item">
                                    <span class="menu-icon">?</span>
                                    <span class="menu-text">Help</span>
                                </div>
                            </div>

                            <!-- Dropdown Menu -->
                            <div class="dropdown-menu visible">
                                <div class="dropdown-item">
                                    <span class="dropdown-icon">??</span>
                                    <span class="dropdown-text">New</span>
                                    <span class="dropdown-shortcut">Ctrl+N</span>
                                </div>
                                <div class="dropdown-item">
                                    <span class="dropdown-icon">??</span>
                                    <span class="dropdown-text">Open</span>
                                    <span class="dropdown-shortcut">Ctrl+O</span>
                                </div>
                                <div class="dropdown-item submenu">
                                    <span class="dropdown-icon">??</span>
                                    <span class="dropdown-text">Recent Files</span>
                                    <span class="dropdown-arrow">?</span>
                                </div>
                                <div class="dropdown-separator"></div>
                                <div class="dropdown-item">
                                    <span class="dropdown-icon">??</span>
                                    <span class="dropdown-text">Save</span>
                                    <span class="dropdown-shortcut">Ctrl+S</span>
                                </div>
                                <div class="dropdown-item">
                                    <span class="dropdown-icon">??</span>
                                    <span class="dropdown-text">Save As...</span>
                                    <span class="dropdown-shortcut">Ctrl+Shift+S</span>
                                </div>
                                <div class="dropdown-separator"></div>
                                <div class="dropdown-item">
                                    <span class="dropdown-icon">??</span>
                                    <span class="dropdown-text">Exit</span>
                                    <span class="dropdown-shortcut">Alt+F4</span>
                                </div>
                            </div>

                        </div>
                        <p><em>BeepMenuBar with File menu expanded showing hierarchical structure</em></p>
                    </div>

                    <style>
                        .visual-demo {
                            border: 2px dashed var(--color-border-light);
                            border-radius: 8px;
                            padding: 2rem;
                            text-align: center;
                            margin: 1rem 0;
                            background: var(--color-background-secondary);
                        }

                        .menubar-preview {
                            position: relative;
                            max-width: 600px;
                            margin: 0 auto;
                            font-family: var(--font-family);
                        }

                        .menubar-container {
                            display: flex;
                            align-items: center;
                            background: var(--color-background);
                            border: 1px solid var(--color-border);
                            border-radius: 4px;
                            padding: 4px 8px;
                            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                        }

                        .menu-item {
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            padding: 8px 16px;
                            cursor: pointer;
                            border-radius: 4px;
                            transition: all 0.2s ease;
                            user-select: none;
                        }

                        .menu-item:hover {
                            background: var(--color-background-secondary);
                        }

                        .menu-item.active {
                            background: var(--color-brand-primary);
                            color: white;
                        }

                        .menu-icon {
                            font-size: 14px;
                            width: 16px;
                            text-align: center;
                        }

                        .menu-text {
                            font-size: 14px;
                            font-weight: 500;
                        }

                        .dropdown-menu {
                            position: absolute;
                            top: 100%;
                            left: 8px;
                            background: var(--color-background);
                            border: 1px solid var(--color-border);
                            border-radius: 6px;
                            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
                            min-width: 220px;
                            padding: 4px 0;
                            z-index: 1000;
                            opacity: 0;
                            visibility: hidden;
                            transform: translateY(-10px);
                            transition: all 0.2s ease;
                        }

                        .dropdown-menu.visible {
                            opacity: 1;
                            visibility: visible;
                            transform: translateY(0);
                        }

                        .dropdown-item {
                            display: flex;
                            align-items: center;
                            gap: 12px;
                            padding: 8px 16px;
                            cursor: pointer;
                            transition: background-color 0.2s ease;
                            user-select: none;
                        }

                        .dropdown-item:hover {
                            background: var(--color-background-secondary);
                        }

                        .dropdown-item.submenu {
                            position: relative;
                        }

                        .dropdown-icon {
                            font-size: 14px;
                            width: 16px;
                            text-align: center;
                        }

                        .dropdown-text {
                            flex: 1;
                            font-size: 13px;
                            text-align: left;
                        }

                        .dropdown-shortcut {
                            font-size: 12px;
                            color: var(--color-text-secondary);
                            margin-left: auto;
                        }

                        .dropdown-arrow {
                            font-size: 10px;
                            color: var(--color-text-secondary);
                            margin-left: auto;
                        }

                        .dropdown-separator {
                            height: 1px;
                            background: var(--color-border-light);
                            margin: 4px 8px;
                        }
                    </style>
                </section>

                <!-- Basic Usage -->
                <section id="basic-usage" class="section">
                    <h2>Basic Usage</h2>
                    
                    <div class="code-example">
                        <h3>Simple Menu Bar</h3>
                        <pre><code class="language-csharp">// Create a basic menu bar
var menuBar = new BeepMenuBar
{
    Dock = DockStyle.Top,
    Height = 35,
    MenuItemWidth = 80,
    MenuItemHeight = 35
};

// Create menu items
var fileMenu = new SimpleItem
{
    Text = "File",
    ImagePath = "file-icon.svg",
    GuidId = Guid.NewGuid().ToString()
};

var editMenu = new SimpleItem
{
    Text = "Edit", 
    ImagePath = "edit-icon.svg",
    GuidId = Guid.NewGuid().ToString()
};

// Add to menu bar
menuBar.MenuItems.Add(fileMenu);
menuBar.MenuItems.Add(editMenu);

// Handle selection
menuBar.SelectedItemChanged += (sender, e) =>
{
    MessageBox.Show($"Selected: {e.SelectedItem.Text}");
};

this.Controls.Add(menuBar);</code></pre>
                    </div>

                    <div class="code-example">
                        <h3>Hierarchical Menu Structure</h3>
                        <pre><code class="language-csharp">// Create File menu with submenus
var fileMenu = new SimpleItem
{
    Text = "File",
    ImagePath = "folder-icon.svg",
    GuidId = Guid.NewGuid().ToString()
};

// Add File submenu items
fileMenu.Children.Add(new SimpleItem
{
    Text = "New",
    ImagePath = "new-file-icon.svg",
    MethodName = "CreateNewFile",
    GuidId = Guid.NewGuid().ToString()
});

fileMenu.Children.Add(new SimpleItem
{
    Text = "Open",
    ImagePath = "open-file-icon.svg",
    MethodName = "OpenFile",
    GuidId = Guid.NewGuid().ToString()
});

// Add separator
fileMenu.Children.Add(new SimpleItem
{
    Text = "-",
    IsSeparator = true,
    GuidId = Guid.NewGuid().ToString()
});

// Recent files submenu
var recentMenu = new SimpleItem
{
    Text = "Recent Files",
    ImagePath = "recent-icon.svg",
    GuidId = Guid.NewGuid().ToString()
};

// Add recent file items dynamically
for (int i = 1; i <= 5; i++)
{
    recentMenu.Children.Add(new SimpleItem
    {
        Text = $"Document{i}.txt",
        MethodName = "OpenRecentFile",
        Tag = $"document{i}.txt",
        GuidId = Guid.NewGuid().ToString()
    });
}

fileMenu.Children.Add(recentMenu);

// Add more File menu items
fileMenu.Children.Add(new SimpleItem
{
    Text = "Save",
    ImagePath = "save-icon.svg",
    MethodName = "SaveFile",
    Shortcut = "Ctrl+S",
    GuidId = Guid.NewGuid().ToString()
});

fileMenu.Children.Add(new SimpleItem
{
    Text = "Exit",
    ImagePath = "exit-icon.svg",
    MethodName = "ExitApplication",
    GuidId = Guid.NewGuid().ToString()
});

menuBar.MenuItems.Add(fileMenu);</code></pre>
                    </div>

                    <div class="code-example">
                        <h3>Complete Application Menu</h3>
                        <pre><code class="language-csharp">public void SetupApplicationMenu()
{
    var menuBar = new BeepMenuBar
    {
        Dock = DockStyle.Top,
        Height = 35,
        ImageSize = 16
    };

    // File Menu
    var fileMenu = CreateFileMenu();
    menuBar.MenuItems.Add(fileMenu);

    // Edit Menu
    var editMenu = CreateEditMenu();
    menuBar.MenuItems.Add(editMenu);

    // View Menu
    var viewMenu = CreateViewMenu();
    menuBar.MenuItems.Add(viewMenu);

    // Tools Menu
    var toolsMenu = CreateToolsMenu();
    menuBar.MenuItems.Add(toolsMenu);

    // Help Menu
    var helpMenu = CreateHelpMenu();
    menuBar.MenuItems.Add(helpMenu);

    this.Controls.Add(menuBar);
}

private SimpleItem CreateFileMenu()
{
    var fileMenu = new SimpleItem
    {
        Text = "File",
        ImagePath = "file-menu-icon.svg",
        GuidId = Guid.NewGuid().ToString()
    };

    fileMenu.Children.AddRange(new[]
    {
        new SimpleItem { Text = "New", ImagePath = "new.svg", MethodName = "NewDocument", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Open", ImagePath = "open.svg", MethodName = "OpenDocument", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Save", ImagePath = "save.svg", MethodName = "SaveDocument", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Save As", ImagePath = "save-as.svg", MethodName = "SaveDocumentAs", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Print", ImagePath = "print.svg", MethodName = "PrintDocument", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Exit", ImagePath = "exit.svg", MethodName = "ExitApplication", GuidId = Guid.NewGuid().ToString() }
    });

    return fileMenu;
}

private SimpleItem CreateEditMenu()
{
    var editMenu = new SimpleItem
    {
        Text = "Edit",
        ImagePath = "edit-menu-icon.svg",
        GuidId = Guid.NewGuid().ToString()
    };

    editMenu.Children.AddRange(new[]
    {
        new SimpleItem { Text = "Undo", ImagePath = "undo.svg", MethodName = "Undo", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Redo", ImagePath = "redo.svg", MethodName = "Redo", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Cut", ImagePath = "cut.svg", MethodName = "Cut", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Copy", ImagePath = "copy.svg", MethodName = "Copy", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Paste", ImagePath = "paste.svg", MethodName = "Paste", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "-", IsSeparator = true, GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Find", ImagePath = "find.svg", MethodName = "Find", GuidId = Guid.NewGuid().ToString() },
        new SimpleItem { Text = "Replace", ImagePath = "replace.svg", MethodName = "Replace", GuidId = Guid.NewGuid().ToString() }
    });

    return editMenu;
}</code></pre>
                    </div>
                </section>

                <!-- Properties -->
                <section id="properties" class="section">
                    <h2>Properties</h2>

                    <h3>Core Properties</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Default</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>MenuItems</code></td>
                                <td>BindingList&lt;SimpleItem&gt;</td>
                                <td>Empty</td>
                                <td>Collection of top-level menu items</td>
                            </tr>
                            <tr>
                                <td><code>SelectedItem</code></td>
                                <td>SimpleItem</td>
                                <td>null</td>
                                <td>Currently selected menu item (read-only)</td>
                            </tr>
                            <tr>
                                <td><code>SelectedIndex</code></td>
                                <td>int</td>
                                <td>-1</td>
                                <td>Index of currently selected menu item</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Layout Properties</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Default</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>MenuItemWidth</code></td>
                                <td>int</td>
                                <td>60</td>
                                <td>Default width for menu items (pixels)</td>
                            </tr>
                            <tr>
                                <td><code>MenuItemHeight</code></td>
                                <td>int</td>
                                <td>35</td>
                                <td>Height of menu items (pixels)</td>
                            </tr>
                            <tr>
                                <td><code>ImageSize</code></td>
                                <td>int</td>
                                <td>20</td>
                                <td>Size of menu item icons (pixels)</td>
                            </tr>
                            <tr>
                                <td><code>TextFont</code></td>
                                <td>Font</td>
                                <td>Arial, 10pt</td>
                                <td>Font used for menu item text</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>State Properties</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>ActivePopupForm</code></td>
                                <td>BeepPopupForm</td>
                                <td>Currently active popup menu form</td>
                            </tr>
                            <tr>
                                <td><code>ActiveMenuButton</code></td>
                                <td>BeepButton</td>
                                <td>Currently active menu button</td>
                            </tr>
                            <tr>
                                <td><code>CurrenItemButton</code></td>
                                <td>BeepButton</td>
                                <td>Button for the current menu item</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>SimpleItem Structure</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>Text</code></td>
                                <td>string</td>
                                <td>Display text for the menu item</td>
                            </tr>
                            <tr>
                                <td><code>ImagePath</code></td>
                                <td>string</td>
                                <td>Path to icon image file</td>
                            </tr>
                            <tr>
                                <td><code>MethodName</code></td>
                                <td>string</td>
                                <td>Method to execute when item is clicked</td>
                            </tr>
                            <tr>
                                <td><code>Children</code></td>
                                <td>List&lt;SimpleItem&gt;</td>
                                <td>Submenu items</td>
                            </tr>
                            <tr>
                                <td><code>GuidId</code></td>
                                <td>string</td>
                                <td>Unique identifier for the menu item</td>
                            </tr>
                            <tr>
                                <td><code>Tag</code></td>
                                <td>object</td>
                                <td>Additional data associated with the item</td>
                            </tr>
                            <tr>
                                <td><code>IsSeparator</code></td>
                                <td>bool</td>
                                <td>Whether the item is a menu separator</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Events -->
                <section id="events" class="section">
                    <h2>Events</h2>

                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>SelectedItemChanged</code></td>
                                <td>EventHandler&lt;SelectedItemChangedEventArgs&gt;</td>
                                <td>Raised when a menu item is selected</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>SelectedItemChangedEventArgs</h3>
                    <table class="property-table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>SelectedItem</code></td>
                                <td>SimpleItem</td>
                                <td>The menu item that was selected</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- Examples -->
                <section id="examples" class="section">
                    <h2>Examples</h2>

                    <div class="code-example">
                        <h3>Document Editor Application</h3>
                        <pre><code class="language-csharp">public partial class DocumentEditor : Form
{
    private BeepMenuBar menuBar;
    private RichTextBox textEditor;
    private string currentFileName;

    public DocumentEditor()
    {
        InitializeComponent();
        SetupMenuBar();
        SetupEditor();
    }

    private void SetupMenuBar()
    {
        menuBar = new BeepMenuBar
        {
            Dock = DockStyle.Top,
            Height = 30,
            MenuItemHeight = 30,
            ImageSize = 16
        };

        // Setup menu structure
        CreateFileMenu();
        CreateEditMenu();
        CreateFormatMenu();
        CreateHelpMenu();

        menuBar.SelectedItemChanged += MenuBar_SelectedItemChanged;
        this.Controls.Add(menuBar);
    }

    private void CreateFileMenu()
    {
        var fileMenu = new SimpleItem
        {
            Text = "File",
            ImagePath = "file.svg",
            GuidId = Guid.NewGuid().ToString()
        };

        fileMenu.Children.AddRange(new[]
        {
            new SimpleItem 
            { 
                Text = "New", 
                ImagePath = "new.svg", 
                MethodName = "NewDocument",
                Shortcut = "Ctrl+N",
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "Open", 
                ImagePath = "open.svg", 
                MethodName = "OpenDocument",
                Shortcut = "Ctrl+O",
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "-", 
                IsSeparator = true, 
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "Save", 
                ImagePath = "save.svg", 
                MethodName = "SaveDocument",
                Shortcut = "Ctrl+S",
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "Save As...", 
                ImagePath = "save-as.svg", 
                MethodName = "SaveDocumentAs",
                Shortcut = "Ctrl+Shift+S",
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "-", 
                IsSeparator = true, 
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "Print", 
                ImagePath = "print.svg", 
                MethodName = "PrintDocument",
                Shortcut = "Ctrl+P",
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "-", 
                IsSeparator = true, 
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "Exit", 
                ImagePath = "exit.svg", 
                MethodName = "ExitApplication",
                GuidId = Guid.NewGuid().ToString() 
            }
        });

        menuBar.MenuItems.Add(fileMenu);
    }

    private void MenuBar_SelectedItemChanged(object sender, SelectedItemChangedEventArgs e)
    {
        var item = e.SelectedItem;
        if (item?.MethodName != null)
        {
            ExecuteMenuAction(item.MethodName, item);
        }
    }

    private void ExecuteMenuAction(string methodName, SimpleItem item)
    {
        switch (methodName)
        {
            case "NewDocument":
                NewDocument();
                break;
            case "OpenDocument":
                OpenDocument();
                break;
            case "SaveDocument":
                SaveDocument();
                break;
            case "SaveDocumentAs":
                SaveDocumentAs();
                break;
            case "PrintDocument":
                PrintDocument();
                break;
            case "ExitApplication":
                ExitApplication();
                break;
            // Add more cases for other menu actions
        }
    }

    private void NewDocument()
    {
        if (CheckForUnsavedChanges())
        {
            textEditor.Clear();
            currentFileName = null;
            this.Text = "Document Editor - New Document";
        }
    }

    private void OpenDocument()
    {
        if (CheckForUnsavedChanges())
        {
            using var openDialog = new OpenFileDialog
            {
                Filter = "Text Files (*.txt)|*.txt|Rich Text Files (*.rtf)|*.rtf|All Files (*.*)|*.*",
                Title = "Open Document"
            };

            if (openDialog.ShowDialog() == DialogResult.OK)
            {
                try
                {
                    textEditor.LoadFile(openDialog.FileName);
                    currentFileName = openDialog.FileName;
                    this.Text = $"Document Editor - {Path.GetFileName(currentFileName)}";
                }
                catch (Exception ex)
                {
                    MessageBox.Show($"Error opening file: {ex.Message}", "Error",
                        MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
            }
        }
    }

    private void SaveDocument()
    {
        if (string.IsNullOrEmpty(currentFileName))
        {
            SaveDocumentAs();
        }
        else
        {
            try
            {
                textEditor.SaveFile(currentFileName);
                this.Text = $"Document Editor - {Path.GetFileName(currentFileName)}";
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Error saving file: {ex.Message}", "Error",
                    MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }
    }

    private bool CheckForUnsavedChanges()
    {
        // Implementation for checking unsaved changes
        // Return true if it's safe to proceed
        return true;
    }
}</code></pre>
                    </div>

                    <div class="code-example">
                        <h3>Dynamic Menu Creation</h3>
                        <pre><code class="language-csharp">public class DynamicMenuBuilder
{
    private BeepMenuBar menuBar;
    private List<Plugin> plugins;

    public DynamicMenuBuilder(BeepMenuBar menuBar)
    {
        this.menuBar = menuBar;
        LoadPlugins();
    }

    public void BuildDynamicMenus()
    {
        // Create standard menus
        CreateStaticMenus();

        // Create plugin menus
        CreatePluginMenus();

        // Create recent files menu
        CreateRecentFilesMenu();

        // Create window menu
        CreateWindowMenu();
    }

    private void CreatePluginMenus()
    {
        if (plugins?.Count > 0)
        {
            var pluginsMenu = new SimpleItem
            {
                Text = "Plugins",
                ImagePath = "plugins.svg",
                GuidId = Guid.NewGuid().ToString()
            };

            foreach (var plugin in plugins)
            {
                var pluginItem = new SimpleItem
                {
                    Text = plugin.Name,
                    ImagePath = plugin.IconPath,
                    MethodName = "ExecutePlugin",
                    Tag = plugin,
                    GuidId = Guid.NewGuid().ToString()
                };

                // Add plugin-specific menu items
                foreach (var action in plugin.Actions)
                {
                    pluginItem.Children.Add(new SimpleItem
                    {
                        Text = action.Name,
                        ImagePath = action.IconPath,
                        MethodName = "ExecutePluginAction",
                        Tag = action,
                        GuidId = Guid.NewGuid().ToString()
                    });
                }

                pluginsMenu.Children.Add(pluginItem);
            }

            menuBar.MenuItems.Add(pluginsMenu);
        }
    }

    private void CreateRecentFilesMenu()
    {
        var recentFiles = GetRecentFiles();
        if (recentFiles?.Count > 0)
        {
            // Find File menu and add Recent Files submenu
            var fileMenu = menuBar.MenuItems.FirstOrDefault(m => m.Text == "File");
            if (fileMenu != null)
            {
                var recentMenu = new SimpleItem
                {
                    Text = "Recent Files",
                    ImagePath = "recent.svg",
                    GuidId = Guid.NewGuid().ToString()
                };

                foreach (var recentFile in recentFiles.Take(10))
                {
                    recentMenu.Children.Add(new SimpleItem
                    {
                        Text = Path.GetFileName(recentFile),
                        MethodName = "OpenRecentFile",
                        Tag = recentFile,
                        ToolTip = recentFile,
                        GuidId = Guid.NewGuid().ToString()
                    });
                }

                // Insert after "Open" menu item
                var openIndex = fileMenu.Children.FindIndex(c => c.Text == "Open");
                if (openIndex >= 0)
                {
                    fileMenu.Children.Insert(openIndex + 1, recentMenu);
                }
            }
        }
    }

    private void CreateWindowMenu()
    {
        var windowMenu = new SimpleItem
        {
            Text = "Window",
            ImagePath = "window.svg",
            GuidId = Guid.NewGuid().ToString()
        };

        // Add window management items
        windowMenu.Children.AddRange(new[]
        {
            new SimpleItem 
            { 
                Text = "Minimize", 
                MethodName = "MinimizeWindow",
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "Maximize", 
                MethodName = "MaximizeWindow",
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "-", 
                IsSeparator = true, 
                GuidId = Guid.NewGuid().ToString() 
            },
            new SimpleItem 
            { 
                Text = "Always on Top", 
                MethodName = "ToggleAlwaysOnTop",
                CheckBox = true,
                GuidId = Guid.NewGuid().ToString() 
            }
        });

        // Add list of open documents
        var openDocuments = GetOpenDocuments();
        if (openDocuments?.Count > 0)
        {
            windowMenu.Children.Add(new SimpleItem 
            { 
                Text = "-", 
                IsSeparator = true, 
                GuidId = Guid.NewGuid().ToString() 
            });

            foreach (var doc in openDocuments)
            {
                windowMenu.Children.Add(new SimpleItem
                {
                    Text = doc.Title,
                    MethodName = "ActivateDocument",
                    Tag = doc,
                    RadioButton = true,
                    Checked = doc.IsActive,
                    GuidId = Guid.NewGuid().ToString()
                });
            }
        }

        menuBar.MenuItems.Add(windowMenu);
    }

    private List<string> GetRecentFiles()
    {
        // Implementation to retrieve recent files from settings
        return new List<string>();
    }

    private List<DocumentInfo> GetOpenDocuments()
    {
        // Implementation to get list of open documents
        return new List<DocumentInfo>();
    }

    private void LoadPlugins()
    {
        // Implementation to load available plugins
        plugins = new List<Plugin>();
    }
}

public class Plugin
{
    public string Name { get; set; }
    public string IconPath { get; set; }
    public List<PluginAction> Actions { get; set; } = new List<PluginAction>();
}

public class PluginAction
{
    public string Name { get; set; }
    public string IconPath { get; set; }
    public string MethodName { get; set; }
}

public class DocumentInfo
{
    public string Title { get; set; }
    public bool IsActive { get; set; }
}</code></pre>
                    </div>
                </section>

                <!-- Theming -->
                <section id="theming" class="section">
                    <h2>Theming</h2>
                    
                    <p>BeepMenuBar provides comprehensive theming with specialized menu styling and proper cascade to all child buttons:</p>

                    <div class="code-example">
                        <h3>Theme Application</h3>
                        <pre><code class="language-csharp">var menuBar = new BeepMenuBar
{
    Theme = "DarkTheme",
    UseThemeFont = true
};

// Theme automatically applies menu-specific colors:
// - MenuBackColor: Main menu bar background
// - MenuForeColor: Menu text color
// - MenuBorderColor: Border colors
// - MenuItemHoverBackColor: Hover effects
// - MenuItemSelectedBackColor: Selected states

// Manual theme application
menuBar.ApplyTheme();</code></pre>
                    </div>

                    <h3>Menu-Specific Theme Properties</h3>
                    <ul>
                        <li><strong>MenuBackColor</strong> - Menu bar background color</li>
                        <li><strong>MenuForeColor</strong> - Menu item text color</li>
                        <li><strong>MenuBorderColor</strong> - Menu borders and separators</li>
                        <li><strong>MenuItemHoverBackColor</strong> - Hover state background</li>
                        <li><strong>MenuItemSelectedBackColor</strong> - Selected item background</li>
                        <li><strong>MenuGradiantStartColor/EndColor</strong> - Gradient backgrounds</li>
                        <li><strong>MenuTitleFont</strong> - Typography for menu items</li>
                    </ul>

                    <div class="code-example">
                        <h3>Custom Menu Styling</h3>
                        <pre><code class="language-csharp">// Create custom menu theme
menuBar.Theme = "CustomMenuTheme";

// Override specific menu colors after theme application
foreach (Control control in menuBar.Controls)
{
    if (control is BeepButton menuButton)
    {
        menuButton.HoverBackColor = Color.FromArgb(45, 45, 48);
        menuButton.SelectedBackColor = Color.FromArgb(0, 122, 204);
        menuButton.ForeColor = Color.White;
    }
}

// Enable gradient background
menuBar.UseGradientBackground = true;
menuBar.GradientStartColor = Color.FromArgb(60, 60, 60);
menuBar.GradientEndColor = Color.FromArgb(40, 40, 40);</code></pre>
                    </div>

                    <h3>Button State Theming</h3>
                    <p>Each menu button supports comprehensive state-based theming:</p>
                    <ul>
                        <li><strong>Normal state</strong> - Default appearance</li>
                        <li><strong>Hover state</strong> - Mouse over effects</li>
                        <li><strong>Selected state</strong> - Active menu button</li>
                        <li><strong>Pressed state</strong> - Click feedback</li>
                        <li><strong>Disabled state</strong> - Inactive menu items</li>
                        <li><strong>Focus state</strong> - Keyboard navigation</li>
                    </ul>
                </section>

                <!-- Best Practices -->
                <section id="best-practices" class="section">
                    <h2>Best Practices</h2>

                    <h3>?? Menu Structure</h3>
                    <ul>
                        <li><strong>Logical grouping:</strong> Group related functionality in the same menu</li>
                        <li><strong>Standard conventions:</strong> Follow platform conventions (File, Edit, View, Help)</li>
                        <li><strong>Separators:</strong> Use separators to group related items within menus</li>
                        <li><strong>Depth limit:</strong> Limit submenu depth to 3 levels maximum</li>
                    </ul>

                    <h3>?? Visual Design</h3>
                    <ul>
                        <li><strong>Consistent icons:</strong> Use consistent icon style and sizing throughout</li>
                        <li><strong>Clear text:</strong> Use clear, descriptive menu item names</li>
                        <li><strong>Keyboard shortcuts:</strong> Display keyboard shortcuts in submenus</li>
                        <li><strong>Visual feedback:</strong> Provide clear hover and selection states</li>
                    </ul>

                    <h3>? Performance</h3>
                    <ul>
                        <li><strong>Lazy loading:</strong> Load submenus only when needed</li>
                        <li><strong>Image optimization:</strong> Use appropriately sized icon images</li>
                        <li><strong>Memory management:</strong> Dispose of popup forms properly</li>
                        <li><strong>Method binding:</strong> Use efficient method resolution</li>
                    </ul>

                    <h3>?? Implementation</h3>
                    <ul>
                        <li><strong>Method names:</strong> Use clear, descriptive method names for actions</li>
                        <li><strong>Error handling:</strong> Implement proper error handling for menu actions</li>
                        <li><strong>State management:</strong> Track and update menu item states appropriately</li>
                        <li><strong>Accessibility:</strong> Support keyboard navigation and screen readers</li>
                    </ul>

                    <div class="tip">
                        <strong>?? Design Tip</strong>
                        <p>Place the most commonly used menu items in the File and Edit menus, and use standard keyboard shortcuts (Ctrl+N, Ctrl+O, Ctrl+S) for familiar actions.</p>
                    </div>

                    <div class="success">
                        <strong>? Success Pattern</strong>
                        <p>Implement a consistent method naming convention and use the global function handler system for clean separation of menu logic from UI code.</p>
                    </div>

                    <div class="warning">
                        <strong>?? Memory Warning</strong>
                        <p>Be careful with popup form management. Ensure proper disposal of popup forms to prevent memory leaks, especially in applications with frequent menu interactions.</p>
                    </div>
                </section>

                <!-- Navigation -->
                <div class="nav-links">
                    <a href="beep-filter.html"><i class="bi bi-arrow-left"></i> BeepFilter</a>
                    <a href="beep-toolstrip.html">BeepToolStrip <i class="bi bi-arrow-right"></i></a>
                </div>

                <!-- Footer -->
                <footer class="documentation-footer">
                    <div class="footer-content">
                        <div class="footer-copyright">
                            <p>&copy; 2024 TheTechIdea - Beep Controls Documentation</p>
                            <p>Supporting .NET 6, 7, 8, and 9 | Windows Forms Applications</p>
                        </div>
                        <div class="footer-links">
                            <a href="../index.html">Home</a>
                            <a href="../getting-started/installation.html">Getting Started</a>
                            <a href="../api/beep-control-base.html">API Reference</a>
                        </div>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const submenus = document.querySelectorAll('.has-submenu > a');
            
            submenus.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const parent = this.parentElement;
                    parent.classList.toggle('open');
                });
            });
        });

        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = body.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
                themeIcon.className = 'bi bi-sun-fill';
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.className = 'bi bi-moon-fill';
                localStorage.setItem('theme', 'dark');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                document.getElementById('theme-icon').className = 'bi bi-moon-fill';
            }
        });

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        function searchDocs(query) {
            const links = document.querySelectorAll('.nav-menu a');
            const lowerQuery = query.toLowerCase();
            
            links.forEach(link => {
                const text = link.textContent.toLowerCase();
                const listItem = link.closest('li');
                
                if (text.includes(lowerQuery) || lowerQuery === '') {
                    listItem.style.display = '';
                } else {
                    listItem.style.display = 'none';
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            const codeBlocks = document.querySelectorAll('pre code');
            
            codeBlocks.forEach(block => {
                const button = document.createElement('button');
                button.textContent = 'Copy';
                button.style.cssText = `
                    position: absolute;
                    top: 8px;
                    right: 8px;
                    background: var(--color-brand-primary);
                    color: white;
                    border: none;
                    border-radius: 4px;
                    padding: 4px 8px;
                    font-size: 12px;
                    cursor: pointer;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                `;
                
                const pre = block.parentElement;
                pre.style.position = 'relative';
                pre.appendChild(button);
                
                pre.addEventListener('mouseenter', () => {
                    button.style.opacity = '1';
                });
                
                pre.addEventListener('mouseleave', () => {
                    button.style.opacity = '0';
                });
                
                button.addEventListener('click', () => {
                    navigator.clipboard.writeText(block.textContent).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
            });
        });
    </script>
</body>

</html>